<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Get started with samplesim • samplesim</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Get started with samplesim">
<meta property="og:description" content="samplesim">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">samplesim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/samplesim.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ahasverus/samplesim/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="samplesim_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Get started with samplesim</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ahasverus/samplesim/blob/master/vignettes/samplesim.Rmd"><code>vignettes/samplesim.Rmd</code></a></small>
      <div class="hidden name"><code>samplesim.Rmd</code></div>

    </div>

    
    
<p>This package allows the investigation of the effect of sample size on estimates and precision of stable isotope mixing solutions calculated with the package <a href="https://cran.r-project.org/web/packages/siar/index.html"><strong>siar</strong></a> or the package <a href="https://cran.r-project.org/web/packages/MixSIAR/index.html"><strong>MixSIAR</strong></a>. Samples sizes are modified assuming a normal distribution with a user defined mean and standard deviation. Samples of different sizes are created from this distribution, and mixing proportions are estimated for several replicates of each sample size using the function <code>siar::siarmcmcdirchletv4()</code> or the function <code><a href="https://rdrr.io/pkg/MixSIAR/man/run_model.html">MixSIAR::run_model()</a></code>.</p>
<div id="data-description" class="section level2">
<h2 class="hasAnchor">
<a href="#data-description" class="anchor"></a>Data description</h2>
<p>Let’s take a look at the data requirements. <code>samplesim</code> needs three types of data:</p>
<ul>
<li>the isotopic plasma values of the consumers;</li>
<li>the isotopic plasma values of the preys (also called sources);</li>
<li>the trophic discrimination factors.</li>
</ul>
<p>Datasets provided in this package come from Killengreen <em>et al.</em> (2011)<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<p>To use these datasets with <code>samplesim</code> we will use the functions <code><a href="https://rdrr.io/pkg/MixSIAR/man/load_mix_data.html">MixSIAR::load_mix_data()</a></code>, <code><a href="https://rdrr.io/pkg/MixSIAR/man/load_source_data.html">MixSIAR::load_source_data()</a></code> and <code><a href="https://rdrr.io/pkg/MixSIAR/man/load_discr_data.html">MixSIAR::load_discr_data()</a></code> to import and format the data.</p>
<div id="consumers" class="section level3">
<h3 class="hasAnchor">
<a href="#consumers" class="anchor"></a>Consumers data</h3>
<p>This dataset contains the isotopic plasma values of the consumers over two (or more) isotopes. It must be structured in a data frame with two (or more) variables. Each column contains the isotopic plasma values of one isotope. In the example provided, this dataset contains two columns:</p>
<ul>
<li>
<code>d13C</code>, describing the plasma values of the d13C isotope</li>
<li>
<code>d15N</code>, describing the plasma values of the d15N isotope</li>
</ul>
<p>Each row of the data frame corresponds to one consumer. Let’s take a look at the dataset available in the <code>samplesim</code> package by importing data with the <code><a href="https://rdrr.io/pkg/MixSIAR/man/load_mix_data.html">MixSIAR::load_mix_data()</a></code> function.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Get the location of the dataset ----</span>
<span class="va">file_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"foxes_consumer.csv"</span>, package <span class="op">=</span> <span class="st">"samplesim"</span><span class="op">)</span>

<span class="co">## Import isotopic plasma values of the consumers ----</span>
<span class="va">consumer</span> <span class="op">&lt;-</span> <span class="fu">MixSIAR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MixSIAR/man/load_mix_data.html">load_mix_data</a></span><span class="op">(</span>filename     <span class="op">=</span> <span class="va">file_path</span>,
                                   iso_names    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"d13C"</span>, <span class="st">"d15N"</span><span class="op">)</span>,
                                   factors      <span class="op">=</span> <span class="cn">NULL</span>,
                                   fac_random   <span class="op">=</span> <span class="cn">NULL</span>,
                                   fac_nested   <span class="op">=</span> <span class="cn">NULL</span>,
                                   cont_effects <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
<p><strong>Important:</strong> currently <code>samplesim</code> is not develop to deal with random factors or continuous covariate.</p>
<p><br></p>
<p>Let’s explore this dataset.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Get the class of the object ----</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">consumer</span><span class="op">)</span>
<span class="co">#&gt; [1] "list"</span>

<span class="co">## Name of the list elements ----</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">consumer</span><span class="op">)</span>
<span class="co">#&gt;  [1] "data"         "data_iso"     "n.iso"        "n.re"         "n.ce"        </span>
<span class="co">#&gt;  [6] "FAC"          "CE"           "CE_orig"      "CE_center"    "CE_scale"    </span>
<span class="co">#&gt; [11] "cont_effects" "MU_names"     "SIG_names"    "iso_names"    "N"           </span>
<span class="co">#&gt; [16] "n.fe"         "n.effects"    "factors"      "fac_random"   "fac_nested"  </span>
<span class="co">#&gt; [21] "fere"</span>

<span class="co">## Print the ten first rows of the isotopic values ----</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">consumer</span><span class="op">$</span><span class="st">"data_iso"</span>, <span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt;         d13C  d15N</span>
<span class="co">#&gt;  [1,] -23.93  8.67</span>
<span class="co">#&gt;  [2,] -24.30  8.42</span>
<span class="co">#&gt;  [3,] -21.46 10.41</span>
<span class="co">#&gt;  [4,] -23.50  8.71</span>
<span class="co">#&gt;  [5,] -24.40  8.55</span>
<span class="co">#&gt;  [6,] -23.96  8.69</span>
<span class="co">#&gt;  [7,] -24.20  8.75</span>
<span class="co">#&gt;  [8,] -20.62  9.20</span>
<span class="co">#&gt;  [9,] -23.64  8.71</span>
<span class="co">#&gt; [10,] -22.69 10.20</span>

<span class="co">## Get the name of the isotopes ----</span>
<span class="va">consumer</span><span class="op">$</span><span class="st">"iso_names"</span>
<span class="co">#&gt; [1] "d13C" "d15N"</span>

<span class="co">## How many consumers are there in the dataset? ----</span>
<span class="va">consumer</span><span class="op">$</span><span class="st">"N"</span>
<span class="co">#&gt; [1] 59</span></code></pre></div>
<p><br></p>
<p>For further details on the function <code><a href="https://rdrr.io/pkg/MixSIAR/man/load_mix_data.html">MixSIAR::load_mix_data()</a></code> the reader is referred to the help page of this function.</p>
</div>
<div id="sources" class="section level3">
<h3 class="hasAnchor">
<a href="#sources" class="anchor"></a>Sources data</h3>
<p>This dataset contains the isotopic plasma values of the sources over two (or more) isotopes. It must be structured in one of two following formats:</p>
<p><em><strong>Format #1</strong></em></p>
<p>A data frame with repeated measurements of plasma isotope (columns) for each source individual (row). In the example provided in <code>samplesim</code>, this dataset contains three columns:</p>
<ul>
<li>
<code>Source</code>: the name of the sources;</li>
<li>
<code>d13C</code>: the plasma values of the d13C isotope;</li>
<li>
<code>d15N</code>: the plasma values of the d15N isotope.</li>
</ul>
<p><em><strong>Format #2</strong></em></p>
<p>A data frame expressing isotopic plasma values as means and standard deviation. This dataset also contains the sample size of each source. In the example provided in <code>samplesim</code>, this dataset contains six columns:</p>
<ul>
<li>
<code>Sources</code>: the name of the sources;</li>
<li>
<code>Meand13C</code>: the mean values of the d13C isotope;</li>
<li>
<code>SDd13C</code>: the standard deviation of the d13C isotope;</li>
<li>
<code>Meand15N</code>: the mean values of the d15N isotope;</li>
<li>
<code>SDd15N</code>: the standard deviation of the d15N isotope;</li>
<li>
<code>n</code>: the sample size of each source.</li>
</ul>
<p><br></p>
<p>Let’s take a look at the dataset available in the <code>samplesim</code> package by importing data with the function <code><a href="https://rdrr.io/pkg/MixSIAR/man/load_source_data.html">MixSIAR::load_source_data()</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Get the location of the dataset ----</span>
<span class="va">file_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"foxes_sources.csv"</span>, package <span class="op">=</span> <span class="st">"samplesim"</span><span class="op">)</span>

<span class="co">## Import mean isotopic plasma values of the sources (Format #1) ----</span>
<span class="va">sources</span> <span class="op">&lt;-</span> <span class="fu">MixSIAR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MixSIAR/man/load_source_data.html">load_source_data</a></span><span class="op">(</span>filename       <span class="op">=</span> <span class="va">file_path</span>,
                                     source_factors <span class="op">=</span> <span class="cn">NULL</span>,
                                     conc_dep       <span class="op">=</span> <span class="cn">FALSE</span>,
                                     data_type      <span class="op">=</span> <span class="st">"means"</span>,
                                     mix            <span class="op">=</span> <span class="va">consumer</span><span class="op">)</span></code></pre></div>
<p><strong>Note</strong>: If your data follow the format #2, replace the value of the argument <code>data_type</code> by <code>raw</code>.</p>
<p><br></p>
<p>Let’s explore this dataset.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Get the class of the object ----</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">sources</span><span class="op">)</span>
<span class="co">#&gt; [1] "list"</span>

<span class="co">## Name of the list elements ----</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">sources</span><span class="op">)</span>
<span class="co">#&gt;  [1] "n.sources"       "source_names"    "S_MU"            "S_SIG"          </span>
<span class="co">#&gt;  [5] "S_factor1"       "S_factor_levels" "conc"            "MU_array"       </span>
<span class="co">#&gt;  [9] "SIG2_array"      "n_array"         "SOURCE_array"    "n.rep"          </span>
<span class="co">#&gt; [13] "by_factor"       "data_type"       "conc_dep"</span>

<span class="co">## Print the mean values of isotopic plasma values ----</span>
<span class="va">sources</span><span class="op">$</span><span class="st">"S_MU"</span>
<span class="co">#&gt;    Meand13C  Meand15N</span>
<span class="co">#&gt; 1 -23.76333  7.316667</span>
<span class="co">#&gt; 2 -27.86783  1.516522</span>
<span class="co">#&gt; 3 -19.19750 11.718500</span>
<span class="co">#&gt; 4 -25.50682  1.175455</span>
<span class="co">#&gt; 5 -25.44462  2.260000</span>
<span class="co">#&gt; 6 -27.75692  3.580000</span>

<span class="co">## Print the SD values of isotopic plasma values ----</span>
<span class="va">sources</span><span class="op">$</span><span class="st">"S_SIG"</span>
<span class="co">#&gt;      SDd13C    SDd15N</span>
<span class="co">#&gt; 1 0.7771658 0.2348333</span>
<span class="co">#&gt; 2 1.2038875 0.7695844</span>
<span class="co">#&gt; 3 0.9401449 1.1056852</span>
<span class="co">#&gt; 4 0.8195143 0.8310677</span>
<span class="co">#&gt; 5 1.1934028 1.4464958</span>
<span class="co">#&gt; 6 0.7273512 1.4099409</span>

<span class="co">## Get the name of the sources ----</span>
<span class="va">sources</span><span class="op">$</span><span class="st">"source_names"</span>
<span class="co">#&gt; [1] "Birds"     "Lemming"   "Marine"    "Ptarmigan" "Reindeer"  "Voles"</span>

<span class="co">## How many sources are there in the dataset? ----</span>
<span class="va">sources</span><span class="op">$</span><span class="st">"n_array"</span>
<span class="co">#&gt; [1]  6 23 20 22 13 13</span></code></pre></div>
<p>For further details on the function <code><a href="https://rdrr.io/pkg/MixSIAR/man/load_source_data.html">MixSIAR::load_source_data()</a></code> the reader is referred to the help page of this function.</p>
</div>
<div id="discrim" class="section level3">
<h3 class="hasAnchor">
<a href="#discrim" class="anchor"></a>Discrimation data</h3>
<p>This dataset contains the trophic discrimination factor (TDF) of two (or more) isotopes for each source. It must be structured following the format #2 of the sources dataset. In the example provided in <code>samplesim</code>, this dataset contains five columns:</p>
<ul>
<li>
<code>Sources</code>: the name of the sources;</li>
<li>
<code>Meand13C</code>: the mean values of the TDF for the d13C isotope;</li>
<li>
<code>SDd13C</code>: the standard deviation of the TDF for the d13C isotope;</li>
<li>
<code>Meand15N</code>: the mean values of the TDF for the d15N isotope;</li>
<li>
<code>SDd15N</code>: the standard deviation of the TDF for the d15N isotope.</li>
</ul>
<p>Let’s take a look at the dataset available in the <code>samplesim</code> package by importing data with the function <code><a href="https://rdrr.io/pkg/MixSIAR/man/load_discr_data.html">MixSIAR::load_discr_data()</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Get the location of the dataset ----</span>
<span class="va">file_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"foxes_discrimination.csv"</span>, package <span class="op">=</span> <span class="st">"samplesim"</span><span class="op">)</span>

<span class="co">## Import TDF values ----</span>
<span class="va">discr</span> <span class="op">&lt;-</span> <span class="fu">MixSIAR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MixSIAR/man/load_discr_data.html">load_discr_data</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="va">file_path</span>, mix <span class="op">=</span> <span class="va">consumer</span><span class="op">)</span></code></pre></div>
<p><br></p>
<p>Let’s explore this dataset.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Get the class of the object ----</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">discr</span><span class="op">)</span>
<span class="co">#&gt; [1] "list"</span>

<span class="co">## Name of the list elements ----</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">discr</span><span class="op">)</span>
<span class="co">#&gt; [1] "mu"   "sig2"</span>

<span class="co">## Print the mean values of TDF ----</span>
<span class="va">discr</span><span class="op">$</span><span class="st">"mu"</span>
<span class="co">#&gt;           Meand13C Meand15N</span>
<span class="co">#&gt; Birds            0        0</span>
<span class="co">#&gt; Lemming          0        0</span>
<span class="co">#&gt; Marine           0        0</span>
<span class="co">#&gt; Ptarmigan        0        0</span>
<span class="co">#&gt; Reindeer         0        0</span>
<span class="co">#&gt; Voles            0        0</span>

<span class="co">## Print the SD values of TDF ----</span>
<span class="va">discr</span><span class="op">$</span><span class="st">"sig2"</span>
<span class="co">#&gt;           SDd13C SDd15N</span>
<span class="co">#&gt; Birds          0      0</span>
<span class="co">#&gt; Lemming        0      0</span>
<span class="co">#&gt; Marine         0      0</span>
<span class="co">#&gt; Ptarmigan      0      0</span>
<span class="co">#&gt; Reindeer       0      0</span>
<span class="co">#&gt; Voles          0      0</span></code></pre></div>
<p>For further details on the function <code><a href="https://rdrr.io/pkg/MixSIAR/man/load_discr_data.html">MixSIAR::load_discr_data()</a></code> the reader is referred to the help page of this function.</p>
</div>
</div>
<div id="data-visualization" class="section level2">
<h2 class="hasAnchor">
<a href="#data-visualization" class="anchor"></a>Data visualization</h2>
<p>The function <code><a href="../reference/plot_isospace.html">samplesim::plot_isospace()</a></code> represents consumer and sources data in the isotopic space. This function is an adaptation of <code><a href="https://rdrr.io/pkg/MixSIAR/man/plot_data.html">MixSIAR::plot_data()</a></code> function and add color to source data. If you want you can export plot in PDF and/or PNG format.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">samplesim</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_isospace.html">plot_isospace</a></span><span class="op">(</span>mix <span class="op">=</span> <span class="va">consumer</span>, source <span class="op">=</span> <span class="va">sources</span>, discr <span class="op">=</span> <span class="va">discr</span><span class="op">)</span></code></pre></div>
<p><img src="samplesim_files/figure-html/unnamed-chunk-8-1.png" width="100%"></p>
<p>If you prefer you can also used the <code><a href="https://rdrr.io/pkg/MixSIAR/man/plot_data.html">MixSIAR::plot_data()</a></code>.</p>
<p>If your data make sense, let’s move forward!</p>
</div>
<div id="running-samplesim" class="section level2">
<h2 class="hasAnchor">
<a href="#running-samplesim" class="anchor"></a>Running samplesim</h2>
<p>The core function of the package is <code><a href="../reference/samplesim.html">samplesim::samplesim()</a></code>. It allows investigating the effect of sample size on estimates and precision of stable isotope mixing solutions. More specifically <code><a href="../reference/samplesim.html">samplesim::samplesim()</a></code> assesses the sensitivity of isotopes mixing models to variation in numbers of samples from source tissues. This tool can be used prior to full-blown studies in a similar manner than power analyses. It used the function <code><a href="https://rdrr.io/pkg/siar/man/siarmcmcdirichletv4.html">siar::siarmcmcdirichletv4()</a></code> developed by Andrew Parnell and available in the package <strong>siar</strong>. <code>samplesim</code> can also be used with the package <strong>MixSIAR</strong> developed by Brian Stock <em>et al.</em>. User can choose to sample one particular source, or all the sources. User can also choose to modify consumer data. Sample sizes are modified assuming a normal distribution with a user defined mean and standard deviation. Samples of different sizes are created from this distribution, and mixing proportions are estimated for several replicates of each sample size.</p>
<p><br></p>
<p>The general writing of <code><a href="../reference/samplesim.html">samplesim::samplesim()</a></code> is:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">samplesim</span><span class="fu">::</span><span class="fu"><a href="../reference/samplesim.html">samplesim</a></span><span class="op">(</span>package     <span class="op">=</span> <span class="st">"siar"</span>,
                     mix         <span class="op">=</span> <span class="va">consumer</span>,
                     source      <span class="op">=</span> <span class="va">sources</span>,
                     discr       <span class="op">=</span> <span class="va">discr</span>,
                     type        <span class="op">=</span> <span class="cn">NULL</span>,
                     nsamples    <span class="op">=</span> <span class="cn">NULL</span>,
                     modify      <span class="op">=</span> <span class="cn">NULL</span>,
                     nrep        <span class="op">=</span> <span class="fl">100</span>,
                     interval    <span class="op">=</span> <span class="fl">90</span>,
                     name        <span class="op">=</span> <span class="cn">NULL</span>,
                     resid_err   <span class="op">=</span> <span class="cn">TRUE</span>,
                     process_err <span class="op">=</span> <span class="cn">FALSE</span>,
                     run         <span class="op">=</span> <span class="st">"test"</span>,
                     alpha.prior <span class="op">=</span> <span class="fl">1</span>,
                     path        <span class="op">=</span> <span class="st">"."</span><span class="op">)</span></code></pre></div>
<p>with:</p>
<ul>
<li>
<code>package</code>, the package name to be used to estimate mixing proportions. Must be one of <code>'siar'</code> or <code>'mixsiar'</code>.</li>
<li>
<code>mix</code>, the output returned by the <code><a href="https://rdrr.io/pkg/MixSIAR/man/load_mix_data.html">MixSIAR::load_mix_data()</a></code> function and containing consumer isotope values (<a href="#consumers">see Consumers data section</a>).</li>
<li>
<code>source</code>, the output returned by the <code><a href="https://rdrr.io/pkg/MixSIAR/man/load_source_data.html">MixSIAR::load_source_data()</a></code> function and containing mean and standard deviation isotope values of sources (and in some case raw values; <a href="#sources">see Preys data section</a>).</li>
<li>
<code>discr</code>, the output returned by the <code><a href="https://rdrr.io/pkg/MixSIAR/man/load_discr_data.html">MixSIAR::load_discr_data()</a></code> function and containing TDF values (<a href="#discrim">see Discrimation data section</a>).</li>
<li>
<code>type</code>, the type of analysis to be run. Must be one of <code>'one source'</code>, <code>'all sources'</code> or <code>'consumer'</code>.</li>
<li>
<code>nsamples</code>, a vector with the sample sizes to simulate.</li>
<li>
<code>modify</code>, the name of the source to modify (case sensitive). This argument has to be specified when the argument <code>type = 'one source'</code>. Otherwise it will be ignored.</li>
<li>
<code>nrep</code>, an integer specifying the number of replicates for each sample sizes. Default is <code>100</code>.</li>
<li>
<code>interval</code>, an integer indicating the width of credible interval to use for precision estimation. Default is <code>90</code>.</li>
<li>
<code>name</code>, a character string giving the name of the simulation. If <code>NULL</code> the simulation will be named by the time of the simulation. This name will be used to create a directory (in <code>path</code>) in which results will be stored.</li>
<li>
<code>resid_err</code>, a boolean indicating if residual error is included in the model. See <code><a href="https://rdrr.io/pkg/MixSIAR/man/run_model.html">?MixSIAR::run_model</a></code> for further information. Only necessary if <code>package = 'mixsiar'</code>.</li>
<li>
<code>process_err</code>, a boolean indicating if process error is included in the model. See <code><a href="https://rdrr.io/pkg/MixSIAR/man/run_model.html">?MixSIAR::run_model</a></code> for further information. Only necessary if <code>package = 'mixsiar'</code>.</li>
<li>
<code>run</code>, a string or a list specifying MCMC parameters. See <code><a href="https://rdrr.io/pkg/MixSIAR/man/run_model.html">?MixSIAR::run_model</a></code> for further information. Only necessary if <code>package = 'mixsiar'</code>.</li>
<li>
<code>alpha.prior</code>, a numeric giving the Dirichlet prior on p.global. See <code><a href="https://rdrr.io/pkg/MixSIAR/man/run_model.html">?MixSIAR::run_model</a></code> for further information. Only necessary if <code>package = 'mixsiar'</code>.</li>
<li>
<code>path</code>, the directory in which the directory <code>name</code> will be created.</li>
</ul>
<p>Let’s take an example. We will assess the impact of the sample size of one source: the source #6 (<em>Voles</em>) with several sample sizes (from 2 to 500). The analysis will be repeated 999 times.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## samplesim run for one source ----</span>
<span class="fu">samplesim</span><span class="fu">::</span><span class="fu"><a href="../reference/samplesim.html">samplesim</a></span><span class="op">(</span>package     <span class="op">=</span> <span class="st">"siar"</span>,
                     mix         <span class="op">=</span> <span class="va">consumer</span>,
                     source      <span class="op">=</span> <span class="va">sources</span>,
                     discr       <span class="op">=</span> <span class="va">discr</span>,
                     type        <span class="op">=</span> <span class="st">"one source"</span>,
                     nsamples    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">25</span>, <span class="fl">50</span>, <span class="fl">75</span>, <span class="fl">100</span>, <span class="fl">150</span>, <span class="fl">250</span>, <span class="fl">500</span><span class="op">)</span>,
                     modify      <span class="op">=</span> <span class="st">"Voles"</span>,
                     nrep        <span class="op">=</span> <span class="fl">999</span>,
                     interval    <span class="op">=</span> <span class="fl">90</span>,
                     name        <span class="op">=</span> <span class="st">"test_siar"</span>,
                     resid_err   <span class="op">=</span> <span class="cn">TRUE</span>,
                     process_err <span class="op">=</span> <span class="cn">FALSE</span>,
                     run         <span class="op">=</span> <span class="st">"test"</span>,
                     alpha.prior <span class="op">=</span> <span class="fl">1</span>,
                     path        <span class="op">=</span> <span class="st">"."</span><span class="op">)</span></code></pre></div>
<p>This function does not return any object in the R console. Instead, results are stored in the directory <code>./test_siar/</code> and they will need to be imported for results visualization (<a href="#results">see below</a>).</p>
<p><strong>Note 1:</strong> if you want to estimate sample size impacts of all sources, you need to set <code>type = "all source"</code>. If you want to assess the impact of the sample size of consumers, you have to set <code>type = "consumer"</code>.</p>
<p><strong>Note 2:</strong> the use of <code>samplesim</code> with the package <code>MixSIAR</code> requires the installation of the software <strong>JAGS</strong>. See the <code>MixSIAR</code> documentation for further details.</p>
</div>
<div id="results" class="section level2">
<h2 class="hasAnchor">
<a href="#results" class="anchor"></a>Results extraction</h2>
<p>The <code><a href="../reference/samplesim.html">samplesim::samplesim()</a></code> function has stored four objects results.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Objects created by samplesim ----</span>
<span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span><span class="st">"./test_siar"</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; [1] "datasets.rds"  "intervals.rds" "logfile.txt"   "medians.rds"  
#&gt; [5] "widths.rds"</code></pre>
<ul>
<li><p><code>intervals</code>, a four dimensions array with the upper and lower bounds of the credible interval for each sample size, replicate and source. First dimension represents lower and upper bounds; second dimension corresponds to the number of sources; third dimension is the number of replicates; and fourth dimension is the number of sample size.</p></li>
<li><p><code>widths</code>, a three dimensions array with the width (precision) of credible intervals for each source, each replicate and each sample size. First dimension corresponds to the number of replicates; second dimension is the number of sources; and third dimension represents the number of sample size.</p></li>
<li><p><code>medians</code>, a three dimensions array with the median (estimate) of credible intervals for each source, each replicate and each sample size. Dimensions are the same as for <code>widths</code> object.</p></li>
<li><p><code>datasets</code>, a four dimensions array with all resampled datasets.</p></li>
</ul>
<p>A <code>logfile.txt</code> is also written and contains all parameters of the simulation. Here’s what it looks like.</p>
<pre><code>#&gt; ====================================================
#&gt;         SampleSim - User-defined parameters
#&gt; ====================================================
#&gt; 
#&gt; Simulation name: test_siar
#&gt; Date: 2017-10-30 10:04:15
#&gt; 
#&gt; Type of sampling: one source
#&gt; Package: siar
#&gt; Modified source: 6
#&gt; Modified source name: Voles
#&gt; Number of replicates by sample size: 999
#&gt; Sample sizes: 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 25, 50, 75, 100, 150, 250, 500
#&gt; Credible intervals width: 90
#&gt; 
#&gt; ====================================================</code></pre>
<p><br></p>
<p>Now, let’s take a look at the results by importing the <code>medians</code> dataset using the R function <code><a href="https://rdrr.io/r/base/readRDS.html">readRDS()</a></code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Import medians of credible intervals ----</span>
<span class="va">medians</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"./test_siar/medians.rds"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Structure of the object ----</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">medians</span><span class="op">)</span>
<span class="co">#&gt; [1] "array"</span>

<span class="co">## Names of the dimensions ----</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span><span class="op">(</span><span class="va">medians</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "replicate" "source"    "size"</span>

<span class="co">## Names of the content of the second dimension ----</span>
<span class="fu"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span><span class="op">(</span><span class="va">medians</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>
<span class="co">#&gt; [1] "Birds"     "Lemming"   "Marine"    "Ptarmigan" "Reindeer"  "Voles"</span>

<span class="co">## Names of the content of the third dimension ----</span>
<span class="fu"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span><span class="op">(</span><span class="va">medians</span><span class="op">)</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>
<span class="co">#&gt;  [1] "size2"   "size3"   "size4"   "size5"   "size6"   "size7"   "size8"  </span>
<span class="co">#&gt;  [8] "size9"   "size10"  "size15"  "size25"  "size50"  "size75"  "size100"</span>
<span class="co">#&gt; [15] "size150" "size250" "size500"</span></code></pre></div>
<p>These data are structured in a three dimensions array.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Extract results of the first replicate ----</span>
<span class="va">medians</span><span class="op">[</span><span class="fl">1</span>, , <span class="op">]</span>
<span class="co">#&gt;            size</span>
<span class="co">#&gt; source           size2      size3      size4      size5      size6      size7</span>
<span class="co">#&gt;   Birds     0.22080350 0.62776762 0.61264482 0.13644333 0.19865157 0.26184595</span>
<span class="co">#&gt;   Lemming   0.02704969 0.03482263 0.03805547 0.02807075 0.02751753 0.02795190</span>
<span class="co">#&gt;   Marine    0.42091005 0.23480681 0.24266042 0.45337319 0.43871829 0.40974112</span>
<span class="co">#&gt;   Ptarmigan 0.01244359 0.01208809 0.01252034 0.01555207 0.01377745 0.01226371</span>
<span class="co">#&gt;   Reindeer  0.01535749 0.01559465 0.01592543 0.01971076 0.01657033 0.01543635</span>
<span class="co">#&gt;   Voles     0.28001983 0.04745384 0.04884126 0.32207617 0.28228077 0.25116073</span>
<span class="co">#&gt;            size</span>
<span class="co">#&gt; source           size8      size9     size10     size15     size25     size50</span>
<span class="co">#&gt;   Birds     0.30183044 0.38733648 0.45307513 0.23657613 0.20437907 0.19557516</span>
<span class="co">#&gt;   Lemming   0.02996436 0.03511950 0.03200601 0.02626679 0.02580987 0.02752152</span>
<span class="co">#&gt;   Marine    0.37579274 0.35325378 0.31980564 0.41866550 0.43434101 0.43018413</span>
<span class="co">#&gt;   Ptarmigan 0.01213490 0.01211281 0.01258004 0.01210336 0.01230684 0.01316829</span>
<span class="co">#&gt;   Reindeer  0.01512387 0.01559267 0.01533496 0.01567057 0.01619438 0.01614120</span>
<span class="co">#&gt;   Voles     0.24124771 0.16962741 0.13970420 0.26877743 0.28654289 0.29286748</span>
<span class="co">#&gt;            size</span>
<span class="co">#&gt; source          size75    size100    size150    size250    size500</span>
<span class="co">#&gt;   Birds     0.28078702 0.22214590 0.27372852 0.25991626 0.29124615</span>
<span class="co">#&gt;   Lemming   0.02644967 0.02626701 0.02796518 0.02962388 0.02789958</span>
<span class="co">#&gt;   Marine    0.39470291 0.42120758 0.40157259 0.40626463 0.39048758</span>
<span class="co">#&gt;   Ptarmigan 0.01221670 0.01292731 0.01233238 0.01226029 0.01248259</span>
<span class="co">#&gt;   Reindeer  0.01583279 0.01628207 0.01517927 0.01536641 0.01498031</span>
<span class="co">#&gt;   Voles     0.24749316 0.27596295 0.24781857 0.25384720 0.24353906</span>

<span class="co">## Compute mean over replicates ----</span>
<span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">medians</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">2</span>, <span class="va">mean</span><span class="op">)</span>
<span class="co">#&gt;          source</span>
<span class="co">#&gt; size          Birds    Lemming    Marine  Ptarmigan   Reindeer     Voles</span>
<span class="co">#&gt;   size2   0.3329619 0.03061553 0.3705592 0.01363248 0.01732562 0.2094417</span>
<span class="co">#&gt;   size3   0.3130829 0.02972203 0.3798494 0.01313642 0.01669658 0.2225842</span>
<span class="co">#&gt;   size4   0.3052444 0.02936399 0.3834885 0.01296013 0.01648190 0.2277861</span>
<span class="co">#&gt;   size5   0.3021503 0.02909928 0.3849340 0.01284955 0.01633875 0.2301904</span>
<span class="co">#&gt;   size6   0.2979120 0.02902469 0.3870687 0.01276708 0.01624129 0.2326831</span>
<span class="co">#&gt;   size7   0.2987177 0.02889796 0.3868250 0.01269072 0.01613967 0.2325208</span>
<span class="co">#&gt;   size8   0.2917118 0.02878715 0.3902268 0.01269980 0.01617898 0.2362354</span>
<span class="co">#&gt;   size9   0.2878275 0.02860285 0.3919790 0.01261217 0.01603715 0.2390753</span>
<span class="co">#&gt;   size10  0.2937751 0.02873353 0.3890670 0.01254136 0.01600089 0.2361770</span>
<span class="co">#&gt;   size15  0.2849223 0.02843139 0.3936390 0.01247700 0.01588973 0.2412083</span>
<span class="co">#&gt;   size25  0.2787882 0.02821472 0.3961160 0.01240432 0.01581604 0.2455782</span>
<span class="co">#&gt;   size50  0.2713784 0.02796116 0.3998587 0.01235301 0.01573552 0.2500490</span>
<span class="co">#&gt;   size75  0.2713068 0.02795011 0.3997937 0.01232842 0.01570429 0.2504130</span>
<span class="co">#&gt;   size100 0.2674633 0.02785936 0.4015903 0.01232672 0.01567834 0.2525580</span>
<span class="co">#&gt;   size150 0.2655944 0.02786962 0.4025579 0.01232220 0.01568122 0.2536192</span>
<span class="co">#&gt;   size250 0.2669552 0.02783585 0.4018200 0.01230325 0.01566581 0.2530809</span>
<span class="co">#&gt;   size500 0.2648996 0.02778607 0.4028678 0.01231153 0.01565910 0.2541631</span></code></pre></div>
<p>The structure of the <code>widths</code> dataset is the same as for <code>medians</code>.</p>
<p><br></p>
<p>If you are uncomfortable to deal with three dimensions arrays, you can use the function <code><a href="../reference/get_output.html">samplesim::get_output()</a></code>. This function converts these two arrays (i.e. <code>medians</code> and <code>widths</code>) into an unique data frame. For instance:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Import medians and widths of credible intervals ----</span>
<span class="va">datas</span> <span class="op">&lt;-</span> <span class="fu">samplesim</span><span class="fu">::</span><span class="fu"><a href="../reference/get_output.html">get_output</a></span><span class="op">(</span><span class="st">"test_siar"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Structure of the data frame ----</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">datas</span><span class="op">)</span>
<span class="co">#&gt; 'data.frame':    203796 obs. of  5 variables:</span>
<span class="co">#&gt;  $ source   : Factor w/ 6 levels "Birds","Lemming",..: 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ size     : Factor w/ 17 levels "2","3","4","5",..: 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ replicate: Factor w/ 999 levels "1","2","3","4",..: 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;  $ value    : num  0.221 0.233 0.336 0.238 0.141 ...</span>
<span class="co">#&gt;  $ type     : Factor w/ 2 levels "Width of credible intervals",..: 2 2 2 2 2 2 2 2 2 2 ...</span>

<span class="co">## Print the first ten and last ten rows ----</span>
<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">datas</span>, <span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">datas</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;        source size replicate     value                             type</span>
<span class="co">#&gt; 1       Birds    2         1 0.2208035 Median of posterior distribution</span>
<span class="co">#&gt; 2       Birds    2         2 0.2325955 Median of posterior distribution</span>
<span class="co">#&gt; 3       Birds    2         3 0.3355217 Median of posterior distribution</span>
<span class="co">#&gt; 4       Birds    2         4 0.2384504 Median of posterior distribution</span>
<span class="co">#&gt; 5       Birds    2         5 0.1406412 Median of posterior distribution</span>
<span class="co">#&gt; 6       Birds    2         6 0.1313651 Median of posterior distribution</span>
<span class="co">#&gt; 7       Birds    2         7 0.1406878 Median of posterior distribution</span>
<span class="co">#&gt; 8       Birds    2         8 0.4972696 Median of posterior distribution</span>
<span class="co">#&gt; 9       Birds    2         9 0.1141554 Median of posterior distribution</span>
<span class="co">#&gt; 10      Birds    2        10 0.5580302 Median of posterior distribution</span>
<span class="co">#&gt; 203787  Voles  500       990 0.2762944      Width of credible intervals</span>
<span class="co">#&gt; 203788  Voles  500       991 0.3304657      Width of credible intervals</span>
<span class="co">#&gt; 203789  Voles  500       992 0.3401727      Width of credible intervals</span>
<span class="co">#&gt; 203790  Voles  500       993 0.3237540      Width of credible intervals</span>
<span class="co">#&gt; 203791  Voles  500       994 0.3211363      Width of credible intervals</span>
<span class="co">#&gt; 203792  Voles  500       995 0.3165708      Width of credible intervals</span>
<span class="co">#&gt; 203793  Voles  500       996 0.3249547      Width of credible intervals</span>
<span class="co">#&gt; 203794  Voles  500       997 0.3427264      Width of credible intervals</span>
<span class="co">#&gt; 203795  Voles  500       998 0.3221002      Width of credible intervals</span>
<span class="co">#&gt; 203796  Voles  500       999 0.3274339      Width of credible intervals</span></code></pre></div>
<p>If you want to select only the <code>widths</code> data,</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Extract widths of credible intervals ----</span>
<span class="va">widths</span> <span class="op">&lt;-</span> <span class="va">datas</span><span class="op">[</span><span class="va">datas</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Width of credible intervals"</span>, <span class="op">]</span>

<span class="co">## Check ----</span>
<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">widths</span>, <span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">widths</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;        source size replicate     value                        type</span>
<span class="co">#&gt; 101899  Birds    2         1 0.5462044 Width of credible intervals</span>
<span class="co">#&gt; 101900  Birds    2         2 0.4793033 Width of credible intervals</span>
<span class="co">#&gt; 101901  Birds    2         3 0.5383797 Width of credible intervals</span>
<span class="co">#&gt; 101902  Birds    2         4 0.5207835 Width of credible intervals</span>
<span class="co">#&gt; 101903  Birds    2         5 0.3767518 Width of credible intervals</span>
<span class="co">#&gt; 101904  Birds    2         6 0.3269237 Width of credible intervals</span>
<span class="co">#&gt; 101905  Birds    2         7 0.3800338 Width of credible intervals</span>
<span class="co">#&gt; 101906  Birds    2         8 0.5436314 Width of credible intervals</span>
<span class="co">#&gt; 101907  Birds    2         9 0.3392450 Width of credible intervals</span>
<span class="co">#&gt; 101908  Birds    2        10 0.4495638 Width of credible intervals</span>
<span class="co">#&gt; 203787  Voles  500       990 0.2762944 Width of credible intervals</span>
<span class="co">#&gt; 203788  Voles  500       991 0.3304657 Width of credible intervals</span>
<span class="co">#&gt; 203789  Voles  500       992 0.3401727 Width of credible intervals</span>
<span class="co">#&gt; 203790  Voles  500       993 0.3237540 Width of credible intervals</span>
<span class="co">#&gt; 203791  Voles  500       994 0.3211363 Width of credible intervals</span>
<span class="co">#&gt; 203792  Voles  500       995 0.3165708 Width of credible intervals</span>
<span class="co">#&gt; 203793  Voles  500       996 0.3249547 Width of credible intervals</span>
<span class="co">#&gt; 203794  Voles  500       997 0.3427264 Width of credible intervals</span>
<span class="co">#&gt; 203795  Voles  500       998 0.3221002 Width of credible intervals</span>
<span class="co">#&gt; 203796  Voles  500       999 0.3274339 Width of credible intervals</span></code></pre></div>
<p>The argument <code>change</code> of the function <code><a href="../reference/get_output.html">samplesim::get_output()</a></code> allows to compute the percentage of change of medians and widths respectively, based on a reference value of sample size (argument <code>reference</code>; default is the minimum sample size). For instance,</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Import medians and widths of credible intervals expressed as percentage of change ----</span>
<span class="va">datas</span> <span class="op">&lt;-</span> <span class="fu">samplesim</span><span class="fu">::</span><span class="fu"><a href="../reference/get_output.html">get_output</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"test_siar"</span>, change <span class="op">=</span> <span class="cn">TRUE</span>, reference <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Structure of the data frame ----</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">datas</span><span class="op">)</span>
<span class="co">#&gt; 'data.frame':    204 obs. of  4 variables:</span>
<span class="co">#&gt;  $ size  : Factor w/ 17 levels "2","3","4","5",..: 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;  $ source: Factor w/ 6 levels "Birds","Lemming",..: 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ value : num  0 -5.97 -8.32 -9.25 -10.53 ...</span>
<span class="co">#&gt;  $ type  : Factor w/ 2 levels "Width of credible intervals",..: 2 2 2 2 2 2 2 2 2 2 ...</span>

<span class="co">## Print the first ten and last ten rows ----</span>
<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">datas</span>, <span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">datas</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;     size source   value                             type</span>
<span class="co">#&gt; 1      2  Birds   0.000 Median of posterior distribution</span>
<span class="co">#&gt; 2      3  Birds  -5.970 Median of posterior distribution</span>
<span class="co">#&gt; 3      4  Birds  -8.325 Median of posterior distribution</span>
<span class="co">#&gt; 4      5  Birds  -9.254 Median of posterior distribution</span>
<span class="co">#&gt; 5      6  Birds -10.527 Median of posterior distribution</span>
<span class="co">#&gt; 6      7  Birds -10.285 Median of posterior distribution</span>
<span class="co">#&gt; 7      8  Birds -12.389 Median of posterior distribution</span>
<span class="co">#&gt; 8      9  Birds -13.555 Median of posterior distribution</span>
<span class="co">#&gt; 9     10  Birds -11.769 Median of posterior distribution</span>
<span class="co">#&gt; 10    15  Birds -14.428 Median of posterior distribution</span>
<span class="co">#&gt; 195    9  Voles  16.622      Width of credible intervals</span>
<span class="co">#&gt; 196   10  Voles  17.953      Width of credible intervals</span>
<span class="co">#&gt; 197   15  Voles  19.374      Width of credible intervals</span>
<span class="co">#&gt; 198   25  Voles  22.240      Width of credible intervals</span>
<span class="co">#&gt; 199   50  Voles  23.303      Width of credible intervals</span>
<span class="co">#&gt; 200   75  Voles  24.175      Width of credible intervals</span>
<span class="co">#&gt; 201  100  Voles  24.054      Width of credible intervals</span>
<span class="co">#&gt; 202  150  Voles  24.592      Width of credible intervals</span>
<span class="co">#&gt; 203  250  Voles  24.804      Width of credible intervals</span>
<span class="co">#&gt; 204  500  Voles  24.730      Width of credible intervals</span></code></pre></div>
<p>Here we notice that the column replicate is omitted and percentages of change are aggregated over replicates.</p>
</div>
<div id="results-visualization" class="section level2">
<h2 class="hasAnchor">
<a href="#results-visualization" class="anchor"></a>Results visualization</h2>
<p>The <code>samplesim</code> package also offers the possibility of visualizing the effect of sample size on the width of the credible interval and on the median of the posterior distribution of the mixing models. This is possible with the function <code><a href="../reference/plot_samplesim.html">samplesim::plot_samplesim()</a></code>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Visualize results ----</span>
<span class="fu">samplesim</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_samplesim.html">plot_samplesim</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"test_siar"</span><span class="op">)</span></code></pre></div>
<p><img src="samplesim_files/figure-html/unnamed-chunk-26-1.png" width="100%"></p>
<p><br></p>
<p>If you prefer you can represent the percentages of change:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Visualize results expressed as percentages of change</span>
<span class="fu">samplesim</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_samplesim.html">plot_samplesim</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"test_siar"</span>, change <span class="op">=</span> <span class="cn">TRUE</span>, reference <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="samplesim_files/figure-html/unnamed-chunk-28-1.png" width="100%"></p>
<p><br></p>
<p>Finally, if you are not satisfied with the quality of the graph, you can customize it by 1) importing data and 2) programming your own graph. Let’s take an example with the <a href="https://cran.r-project.org/web/packages/ggplot2/index.html"><strong>ggplot2</strong></a> package (used in <code>samplesim</code>).</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Import medians and widths of credible intervals ----</span>
<span class="va">datas</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_output.html">get_output</a></span><span class="op">(</span><span class="st">"test_siar"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">size</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">datas</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">source</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.8</span>, outlier.shape <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Sample size"</span>, y <span class="op">=</span> <span class="st">"Values"</span>, fill <span class="op">=</span> <span class="st">"Sources"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>, legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">type</span><span class="op">)</span></code></pre></div>
<p><img src="samplesim_files/figure-html/unnamed-chunk-31-1.png" width="100%"></p>
<p><br></p>
<p>Or your can only represent the medians values. For instance (with percentages of change):</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Import medians and widths of credible intervals ----</span>
<span class="va">datas</span> <span class="op">&lt;-</span> <span class="fu">samplesim</span><span class="fu">::</span><span class="fu"><a href="../reference/get_output.html">get_output</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"test_siar"</span>, change <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Select only medians of credible intervals ----</span>
<span class="va">medians</span> <span class="op">&lt;-</span> <span class="va">datas</span><span class="op">[</span><span class="va">datas</span><span class="op">$</span><span class="st">"type"</span> <span class="op">==</span> <span class="st">"Median of posterior distribution"</span>, <span class="op">]</span>

<span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">size</span>, y <span class="op">=</span> <span class="va">value</span>, group <span class="op">=</span> <span class="va">source</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">medians</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">source</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">source</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Sample size"</span>, y <span class="op">=</span> <span class="st">"Change in medians (%)"</span>, color <span class="op">=</span> <span class="st">"Sources"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_light</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>, legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="samplesim_files/figure-html/unnamed-chunk-34-1.png" width="100%"></p>
</div>
<div id="reference" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#reference" class="anchor"></a>Reference</h2>
<p>Lecomte N., Ehrich D., Casajus N., Berteaux D., Cameron C., and Yoccoz N.G. How many is enough? An R package for evaluating the effect of sample size on estimates and precision of stable isotope mixing solutions. Submitted to <em>Methods in Ecology and Evolution</em>.</p>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Killengreen S., Lecomte N., Ehrich D., Schott T., Yoccoz N.G. and Ims R.A. (2011) The importance of marine vs. human-induced subsidies in the maintenance of an expanding mesocarnivore in the arctic tundra. <em>Journal of Animal Ecology</em>, <strong>80</strong>, 1049-1060.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Nicolas Casajus, Cassandra Cameron, Dorothee Ehrich, Nicolas Lecomte.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
